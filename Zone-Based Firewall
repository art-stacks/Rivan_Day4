Policy Based Firewall

1. Define Zones and Interfaces

!@FW
conf t
 zone security OUTSIDE
  description PUBLIC_INTERFACE
 zone security INSIDE
  description LOCAL_LAN
 zone security DMZ
  description SECURE_PUB_SERVERS
 !
 int g1
  zone-member security OUTSIDE
 int g2
  zone-member security INSIDE
 int g3
  zone-member security DMZ
  end

2. Create an ACL to match traffic rules

!@FW
conf t
 ip access-list extended INSIDE-TO-OUTSIDE
  10 permit ip any any
 ip access-list extended OUTSIDE-TO-INSIDE
  10 deny ip any any
  end


3. Group traffic using Class Maps

!@FW
conf t
 class-map type inspect match-any CM-IN-TO-OUT
  match access-group name INSIDE-TO-OUTSIDE
 class-map type inspect match-any CM-OUT-TO-IN
  match access-group name OUTSIDE-TO-INSIDE
  end


4. Define Policy Maps to Act on the traffic (ex. inspect, drop, pass, log)

!@FW
conf t
 policy-map type inspect INSIDE-OUTSIDE-POLICY
  class class-default
   drop log
 policy-map type inspect OUTSIDE-INSIDE-POLICY
  class class-default
   drop log
   end


5. Define Zone-Pairs to link source and destination zone to policies in a specific direction.

!@FW
conf t
 zone-pair security INSIDE-OUTSIDE source INSIDE destination OUTSIDE
  service-policy type inspect INSIDE-OUTSIDE-POLICY
 zone-pair security OUTSIDE-INSIDE source OUTSIDE destination INSIDE
  service-policy type inspect OUTSIDE-INSIDE-POLICY
  end

 
 
=========================================================
Setup:

FIREWALL
CSR1000V
 
Create Zones 
- INSIDE
- OUTSIDE
- DMZ
 
Create a Policy for OUTSIDE-INSIDE : zero-trust deny any any

ALLOW-SERVICE INSIDE - OUTSIDE : INSPECT
ZERO-TRUST OUTSIDE - INSIDE : DROP
 
 In a Cisco zone-based firewall, inspect is stateful, allowing return traffic automatically by creating a connection state entry, 
 
 while pass is stateless and allows traffic in only one direction, requiring a separate policy for the return flow.
